# å¤šåº”ç”¨é…ç½®ä½¿ç”¨æŒ‡å—

æœ¬æŒ‡å—å°†æ•™æ‚¨å¦‚ä½•ä½¿ç”¨é…ç½®æ–‡ä»¶ç³»ç»Ÿï¼Œå¿«é€Ÿåˆ›å»ºå’Œç®¡ç†å¤šä¸ªWebViewåº”ç”¨ã€‚

## ğŸ¯ æ ¸å¿ƒæ¦‚å¿µ

è¿™ä¸ªReact Nativeé¡¹ç›®è¢«è®¾è®¡ä¸ºä¸€ä¸ª**é€šç”¨WebViewæ¡†æ¶**ï¼Œå…è®¸æ‚¨é€šè¿‡ç®€å•çš„é…ç½®æ–‡ä»¶åˆ›å»ºå¤šä¸ªä¸åŒçš„åº”ç”¨ï¼Œè€Œæ— éœ€ä¿®æ”¹ä»£ç ã€‚

### å·¥ä½œåŸç†

```
assets/build.app â†’ æŒ‡å®šè¦æ„å»ºçš„åº”ç”¨ â†’ è¯»å–å¯¹åº”é…ç½® â†’ åº”ç”¨åˆ°é¡¹ç›® â†’ æ„å»º
```

## ğŸ“– 5åˆ†é’Ÿå¿«é€Ÿæ•™ç¨‹

### æ­¥éª¤1ï¼šåˆ›å»ºæ–°åº”ç”¨é…ç½®

```bash
# åˆ›å»ºæ–°åº”ç”¨ç›®å½•
mkdir -p assets/my-awesome-app

# åˆ›å»ºé…ç½®æ–‡ä»¶
cat > assets/my-awesome-app/app.cfg << 'EOF'
appName=æˆ‘çš„è¶…æ£’åº”ç”¨
appDisplayName=MyAwesomeApp
appId=com.mycompany.awesomeapp
appVersion=1.0.0
buildNumber=1
buildAndroid=true
buildIOS=true
isDebug=false
loadUrl=https://www.example.com
enableJavaScript=true
enableDOMStorage=true
enableCache=true
loadingDuration=1500
loadingBackgroundColor=#FF6B6B
EOF
```

### æ­¥éª¤2ï¼šæ·»åŠ èµ„æºæ–‡ä»¶

```bash
# å¤åˆ¶æˆ–æ·»åŠ æ‚¨çš„å›¾ç‰‡
cp your-loading-image.png assets/my-awesome-app/loading.png
cp your-app-icon.png assets/my-awesome-app/icon.png
```

### æ­¥éª¤3ï¼šæŒ‡å®šè¦æ„å»ºçš„åº”ç”¨

```bash
echo "my-awesome-app" > assets/build.app
```

### æ­¥éª¤4ï¼šåº”ç”¨é…ç½®å¹¶è¿è¡Œ

```bash
# åº”ç”¨é…ç½®
npm run build:config

# è¿è¡ŒAndroid
npm run android

# æˆ–è¿è¡ŒiOS
npm run ios
```

å°±è¿™ä¹ˆç®€å•ï¼ğŸ‰

## ğŸ“± å®é™…åº”ç”¨åœºæ™¯

### åœºæ™¯1ï¼šä¸ºä¸åŒå®¢æˆ·å®šåˆ¶åº”ç”¨

```
assets/
â”œâ”€â”€ build.app
â”œâ”€â”€ client-a/          # å®¢æˆ·Açš„åº”ç”¨
â”‚   â”œâ”€â”€ app.cfg       # URL: https://client-a.com
â”‚   â””â”€â”€ loading.png
â”œâ”€â”€ client-b/          # å®¢æˆ·Bçš„åº”ç”¨
â”‚   â”œâ”€â”€ app.cfg       # URL: https://client-b.com
â”‚   â””â”€â”€ loading.png
â””â”€â”€ client-c/          # å®¢æˆ·Cçš„åº”ç”¨
    â”œâ”€â”€ app.cfg       # URL: https://client-c.com
    â””â”€â”€ loading.png
```

æ„å»ºä¸åŒå®¢æˆ·çš„åº”ç”¨ï¼š

```bash
# æ„å»ºå®¢æˆ·Açš„åº”ç”¨
echo "client-a" > assets/build.app
npm run build:config && npm run android

# æ„å»ºå®¢æˆ·Bçš„åº”ç”¨
echo "client-b" > assets/build.app
npm run build:config && npm run android

# æ„å»ºå®¢æˆ·Cçš„åº”ç”¨
echo "client-c" > assets/build.app
npm run build:config && npm run android
```

### åœºæ™¯2ï¼šæµ‹è¯•ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒ

```
assets/
â”œâ”€â”€ myapp-dev/         # å¼€å‘ç¯å¢ƒ
â”‚   â””â”€â”€ app.cfg       # loadUrl=https://dev.myapp.com
â”œâ”€â”€ myapp-staging/     # æµ‹è¯•ç¯å¢ƒ
â”‚   â””â”€â”€ app.cfg       # loadUrl=https://staging.myapp.com
â””â”€â”€ myapp-prod/        # ç”Ÿäº§ç¯å¢ƒ
    â””â”€â”€ app.cfg       # loadUrl=https://www.myapp.com
```

### åœºæ™¯3ï¼šä¸åŒå“ç‰Œçš„åº”ç”¨

```
assets/
â”œâ”€â”€ brand-red/         # çº¢è‰²ä¸»é¢˜å“ç‰Œ
â”‚   â”œâ”€â”€ app.cfg       # loadingBackgroundColor=#FF0000
â”‚   â””â”€â”€ loading.png
â”œâ”€â”€ brand-blue/        # è“è‰²ä¸»é¢˜å“ç‰Œ
â”‚   â”œâ”€â”€ app.cfg       # loadingBackgroundColor=#0000FF
â”‚   â””â”€â”€ loading.png
â””â”€â”€ brand-green/       # ç»¿è‰²ä¸»é¢˜å“ç‰Œ
    â”œâ”€â”€ app.cfg       # loadingBackgroundColor=#00FF00
    â””â”€â”€ loading.png
```

## ğŸ”„ åˆ‡æ¢åº”ç”¨é…ç½®

### æ–¹æ³•1ï¼šç›´æ¥ä¿®æ”¹build.app

```bash
# æŸ¥çœ‹å½“å‰é…ç½®
cat assets/build.app

# åˆ‡æ¢åˆ°app2
echo "app2" > assets/build.app

# åº”ç”¨é…ç½®
npm run build:config

# æŸ¥çœ‹ç”Ÿæ•ˆçš„é…ç½®
npm run config:check
```

### æ–¹æ³•2ï¼šä½¿ç”¨å‘½ä»¤è¡Œå‚æ•°ï¼ˆåˆ›å»ºè„šæœ¬ï¼‰

åˆ›å»º `scripts/build-app.sh`ï¼š

```bash
#!/bin/bash

if [ -z "$1" ]; then
  echo "Usage: ./scripts/build-app.sh <app-name>"
  exit 1
fi

APP_NAME=$1
echo "ğŸš€ Building $APP_NAME..."

# è®¾ç½®è¦æ„å»ºçš„åº”ç”¨
echo "$APP_NAME" > assets/build.app

# åº”ç”¨é…ç½®
npm run build:config

# æ„å»ºAndroid
cd android && ./gradlew assembleRelease && cd ..

echo "âœ… Build complete: android/app/build/outputs/apk/release/app-release.apk"
```

ä½¿ç”¨ï¼š

```bash
chmod +x scripts/build-app.sh
./scripts/build-app.sh app1
./scripts/build-app.sh app2
./scripts/build-app.sh my-awesome-app
```

## ğŸ“‹ é…ç½®æ–‡ä»¶æ¨¡æ¿

### åŸºç¡€æ¨¡æ¿

```properties
# åº”ç”¨åŸºæœ¬ä¿¡æ¯ï¼ˆå¿…éœ€ï¼‰
appName=åº”ç”¨åç§°
appDisplayName=AppName
appId=com.company.appname
appVersion=1.0.0
buildNumber=1

# æ„å»ºé…ç½®
buildAndroid=true
buildIOS=true
isDebug=false

# WebViewé…ç½®ï¼ˆå¿…éœ€ï¼‰
loadUrl=https://www.example.com
enableJavaScript=true
enableDOMStorage=true
enableCache=true

# Loadingé¡µé¢é…ç½®
loadingDuration=1000
loadingBackgroundColor=#4A90E2
```

### å®Œæ•´æ¨¡æ¿ï¼ˆåŒ…å«æ‰€æœ‰é€‰é¡¹ï¼‰

```properties
# ===== åº”ç”¨åŸºæœ¬ä¿¡æ¯ =====
appName=åº”ç”¨åç§°
appDisplayName=AppDisplayName
appId=com.company.appname
appVersion=1.0.0
buildNumber=1

# ===== æ„å»ºé…ç½® =====
buildAndroid=true
buildIOS=true
isDebug=false

# ===== WebViewé…ç½® =====
loadUrl=https://www.example.com
enableJavaScript=true
enableDOMStorage=true
enableCache=true

# ===== Loadingé¡µé¢é…ç½® =====
loadingDuration=1000
loadingBackgroundColor=#4A90E2

# ===== Androidé…ç½® =====
androidMinSdkVersion=21
androidTargetSdkVersion=34
androidCompileSdkVersion=34

# ===== iOSé…ç½® =====
iosDeploymentTarget=13.0
iosBundleDisplayName=AppName

# ===== èµ„æºæ–‡ä»¶ =====
appIcon=icon.png
loadingImage=loading.png
splashScreen=splash.png
```

## ğŸ¨ èµ„æºæ–‡ä»¶å‡†å¤‡æŒ‡å—

### Loadingå›¾ç‰‡ (loading.png)

**æ¨èå°ºå¯¸**: 800x600 æˆ– 1200x900

**è®¾è®¡å»ºè®®**:
- ä½¿ç”¨PNGæ ¼å¼æ”¯æŒé€æ˜èƒŒæ™¯
- ç®€æ´æ˜äº†çš„è®¾è®¡
- ä¸åº”ç”¨ä¸»é¢˜è‰²ä¸€è‡´
- æ–‡ä»¶å¤§å°æ§åˆ¶åœ¨500KBä»¥å†…

**åœ¨çº¿å·¥å…·**:
- Canva: https://www.canva.com/
- Figma: https://www.figma.com/
- Photopea: https://www.photopea.com/ (å…è´¹åœ¨çº¿PS)

### åº”ç”¨å›¾æ ‡ (icon.png)

**å¿…éœ€å°ºå¯¸**: 1024x1024

**è®¾è®¡è¦æ±‚**:
- æ­£æ–¹å½¢
- PNGæ ¼å¼
- ä¸è¦åŒ…å«åœ†è§’ï¼ˆç³»ç»Ÿä¼šè‡ªåŠ¨æ·»åŠ ï¼‰
- ä¸è¦åŒ…å«é€æ˜åº¦ï¼ˆAndroidè¦æ±‚ï¼‰
- æ¸…æ™°ç®€æ´çš„è®¾è®¡

**å›¾æ ‡ç”Ÿæˆå·¥å…·**:
- https://icon.kitchen/ (æ¨èï¼Œå…è´¹)
- https://appicon.co/
- https://makeappicon.com/

### å¯åŠ¨å±å¹• (splash.png)

**æ¨èå°ºå¯¸**: 1242x2688 (iPhone æœ€å¤§å°ºå¯¸)

**è®¾è®¡å»ºè®®**:
- ä¸loadingé¡µé¢é£æ ¼ä¸€è‡´
- å¯é€‰åŠŸèƒ½ï¼Œä¸æ˜¯å¿…éœ€çš„

## ğŸ”§ é«˜çº§é…ç½®æŠ€å·§

### 1. é…ç½®ç»§æ‰¿ï¼ˆé€šè¿‡è„šæœ¬å®ç°ï¼‰

åˆ›å»º `assets/base.cfg` ä½œä¸ºåŸºç¡€é…ç½®ï¼š

```properties
# åŸºç¡€é…ç½®
enableJavaScript=true
enableDOMStorage=true
enableCache=true
loadingDuration=1000
androidMinSdkVersion=21
androidTargetSdkVersion=34
```

ç„¶ååœ¨å…·ä½“åº”ç”¨é…ç½®ä¸­åªè¦†ç›–éœ€è¦çš„é¡¹ã€‚

### 2. ç¯å¢ƒå˜é‡æ”¯æŒ

ä¿®æ”¹ `scripts/apply-config.js` æ”¯æŒç¯å¢ƒå˜é‡ï¼š

```javascript
// ç¤ºä¾‹ï¼šä»ç¯å¢ƒå˜é‡è¯»å–URL
config.loadUrl = process.env.APP_URL || config.loadUrl;
```

ä½¿ç”¨ï¼š

```bash
APP_URL=https://staging.example.com npm run build:config
```

### 3. é…ç½®éªŒè¯

åˆ›å»º `scripts/validate-config.js` éªŒè¯é…ç½®ï¼š

```javascript
function validateConfig(config) {
  const required = ['appName', 'appId', 'appVersion', 'loadUrl'];
  
  for (const key of required) {
    if (!config[key]) {
      throw new Error(`å¿…éœ€é…ç½®é¡¹ç¼ºå¤±: ${key}`);
    }
  }
  
  // éªŒè¯appIdæ ¼å¼
  if (!/^[a-z][a-z0-9_]*(\.[a-z][a-z0-9_]*)+$/.test(config.appId)) {
    throw new Error('appIdæ ¼å¼é”™è¯¯');
  }
  
  console.log('âœ… é…ç½®éªŒè¯é€šè¿‡');
}
```

## ğŸ“¦ æ‰¹é‡æ„å»ºç¤ºä¾‹

### æ„å»ºæ‰€æœ‰åº”ç”¨

åˆ›å»º `scripts/build-all.sh`ï¼š

```bash
#!/bin/bash

# é¢œè‰²è¾“å‡º
RED='\033[0;31m'
GREEN='\033[0;32m'
BLUE='\033[0;34m'
NC='\033[0m' # No Color

# åˆ›å»ºè¾“å‡ºç›®å½•
mkdir -p releases

# è·å–æ‰€æœ‰åº”ç”¨ç›®å½•
apps=($(ls -d assets/*/ | xargs -n 1 basename))

echo -e "${BLUE}ğŸ“¦ å¼€å§‹æ‰¹é‡æ„å»º...${NC}"
echo -e "${BLUE}æ‰¾åˆ° ${#apps[@]} ä¸ªåº”ç”¨é…ç½®${NC}\n"

for app in "${apps[@]}"
do
  # è·³è¿‡éåº”ç”¨ç›®å½•
  if [ ! -f "assets/$app/app.cfg" ]; then
    continue
  fi
  
  echo -e "${GREEN}æ„å»ºåº”ç”¨: $app${NC}"
  
  # è®¾ç½®è¦æ„å»ºçš„åº”ç”¨
  echo "$app" > assets/build.app
  
  # åº”ç”¨é…ç½®
  npm run build:config
  
  # æ„å»ºAndroid APK
  cd android
  ./gradlew assembleRelease
  cd ..
  
  # å¤åˆ¶åˆ°releasesç›®å½•
  cp android/app/build/outputs/apk/release/app-release.apk "releases/${app}.apk"
  
  echo -e "${GREEN}âœ… $app æ„å»ºå®Œæˆ${NC}\n"
done

echo -e "${BLUE}ğŸ‰ æ‰€æœ‰åº”ç”¨æ„å»ºå®Œæˆï¼${NC}"
echo -e "${BLUE}è¾“å‡ºç›®å½•: releases/${NC}"
ls -lh releases/
```

ä½¿ç”¨ï¼š

```bash
chmod +x scripts/build-all.sh
./scripts/build-all.sh
```

## ğŸ” è°ƒè¯•æŠ€å·§

### æŸ¥çœ‹å½“å‰é…ç½®

```bash
# æŸ¥çœ‹è¦æ„å»ºçš„åº”ç”¨
cat assets/build.app

# æŸ¥çœ‹é…ç½®å†…å®¹
cat assets/$(cat assets/build.app)/app.cfg

# æŸ¥çœ‹ç”Ÿæˆçš„è¿è¡Œæ—¶é…ç½®
cat src/config/runtime.config.ts

# ä½¿ç”¨è„šæœ¬æŸ¥çœ‹
npm run config:check
```

### é…ç½®å·®å¼‚å¯¹æ¯”

```bash
# å¯¹æ¯”ä¸¤ä¸ªåº”ç”¨çš„é…ç½®
diff assets/app1/app.cfg assets/app2/app.cfg
```

### æµ‹è¯•é…ç½®ä¸åŒçš„åº”ç”¨

```bash
# ç»ˆç«¯1ï¼šæ„å»ºapp1
echo "app1" > assets/build.app
npm run build:config
npm run android

# ç»ˆç«¯2ï¼šåŒæ—¶æ„å»ºapp2åˆ°å¦ä¸€ä¸ªè®¾å¤‡
echo "app2" > assets/build.app
npm run build:config
npm run android -- --deviceId=emulator-5556
```

## ğŸš€ CI/CDé›†æˆ

### GitHub Actionsè‡ªåŠ¨æ„å»º

é¡¹ç›®å·²é…ç½®GitHub Actionsï¼Œæ¨é€ä»£ç æ—¶ä¼šè‡ªåŠ¨ï¼š
1. è¯»å– `assets/build.app`
2. åº”ç”¨å¯¹åº”é…ç½®
3. æ„å»ºAndroidå’ŒiOS

### ä½¿ç”¨GitHub Actionsæ„å»ºä¸åŒåº”ç”¨

**æ–¹æ³•1ï¼šä½¿ç”¨ä¸åŒåˆ†æ”¯**

```bash
# åˆ›å»ºapp1åˆ†æ”¯
git checkout -b release/app1
echo "app1" > assets/build.app
git add . && git commit -m "Build app1"
git push origin release/app1

# åˆ›å»ºapp2åˆ†æ”¯
git checkout -b release/app2
echo "app2" > assets/build.app
git add . && git commit -m "Build app2"
git push origin release/app2
```

**æ–¹æ³•2ï¼šä½¿ç”¨Gitæ ‡ç­¾**

```bash
# ä¸ºapp1åˆ›å»ºæ ‡ç­¾
echo "app1" > assets/build.app
git add . && git commit -m "Prepare app1 v1.0.0"
git tag -a app1-v1.0.0 -m "App1 version 1.0.0"
git push origin app1-v1.0.0

# ä¸ºapp2åˆ›å»ºæ ‡ç­¾
echo "app2" > assets/build.app
git add . && git commit -m "Prepare app2 v2.0.0"
git tag -a app2-v2.0.0 -m "App2 version 2.0.0"
git push origin app2-v2.0.0
```

## ğŸ“Š é…ç½®ç®¡ç†æœ€ä½³å®è·µ

### 1. ç‰ˆæœ¬æ§åˆ¶

```bash
# æäº¤é…ç½®å˜æ›´
git add assets/app1/app.cfg
git commit -m "feat(app1): update loadUrl to new domain"

# ä½¿ç”¨æœ‰æ„ä¹‰çš„æäº¤ä¿¡æ¯
git commit -m "feat(app2): upgrade to version 2.0.0"
git commit -m "fix(app1): correct loading duration"
git commit -m "style(app3): update loading image"
```

### 2. é…ç½®æ–‡æ¡£åŒ–

åœ¨æ¯ä¸ªåº”ç”¨ç›®å½•åˆ›å»º `README.md`ï¼š

```markdown
# App1 - ç™¾åº¦åº”ç”¨

## é…ç½®è¯´æ˜
- ç›®æ ‡ç”¨æˆ·ï¼šä¸­å›½ç”¨æˆ·
- åŠ è½½URLï¼šhttps://www.baidu.com
- ä¸»é¢˜è‰²ï¼šè“è‰²

## ç‰ˆæœ¬å†å²
- v1.0.0 (2024-01-01): åˆå§‹ç‰ˆæœ¬
- v1.0.1 (2024-01-15): ä¿®å¤åŠ è½½é—®é¢˜

## ç»´æŠ¤äººå‘˜
- å¼ ä¸‰ (zhangsan@example.com)
```

### 3. é…ç½®å®¡æ ¸

å»ºè®®ä½¿ç”¨Pull Requestå®¡æ ¸é…ç½®å˜æ›´ï¼š

```bash
git checkout -b update/app1-config
# ä¿®æ”¹é…ç½®
git add assets/app1/
git commit -m "update: app1 configuration"
git push origin update/app1-config
# åˆ›å»ºPRè¿›è¡Œå®¡æ ¸
```

## â“ å¸¸è§é—®é¢˜

### Q1: ä¿®æ”¹é…ç½®åæ²¡æœ‰ç”Ÿæ•ˆï¼Ÿ

```bash
# 1. é‡æ–°åº”ç”¨é…ç½®
npm run build:config

# 2. æ¸…ç†ç¼“å­˜
npm start -- --reset-cache

# 3. é‡æ–°æ„å»º
cd android && ./gradlew clean && cd ..
npm run android
```

### Q2: å¦‚ä½•å¿«é€Ÿåˆ›å»ºæ–°åº”ç”¨ï¼Ÿ

```bash
# å¤åˆ¶ç°æœ‰é…ç½®
cp -r assets/app1 assets/new-app

# ä¿®æ”¹é…ç½®æ–‡ä»¶
vim assets/new-app/app.cfg

# æ›¿æ¢èµ„æºæ–‡ä»¶
# ...

# æ„å»º
echo "new-app" > assets/build.app
npm run build:config
```

### Q3: å¯ä»¥åœ¨ä¸€å°ç”µè„‘ä¸ŠåŒæ—¶å¼€å‘å¤šä¸ªåº”ç”¨å—ï¼Ÿ

å¯ä»¥ï¼ä½¿ç”¨ä¸åŒçš„ç»ˆç«¯çª—å£å’Œè®¾å¤‡ï¼š

```bash
# ç»ˆç«¯1
echo "app1" > assets/build.app
npm run android -- --deviceId=device1

# ç»ˆç«¯2
echo "app2" > assets/build.app  
npm run android -- --deviceId=device2
```

### Q4: é…ç½®æ–‡ä»¶æ”¯æŒæ³¨é‡Šå—ï¼Ÿ

æ”¯æŒï¼ä½¿ç”¨ `#` å¼€å¤´çš„è¡Œä¼šè¢«å¿½ç•¥ï¼š

```properties
# è¿™æ˜¯æ³¨é‡Š
appName=æˆ‘çš„åº”ç”¨  # è¡Œå†…æ³¨é‡Šä¸æ”¯æŒ
```

## ğŸ“š æ›´å¤šèµ„æº

- [é…ç½®æ–‡ä»¶è¯´æ˜.md](./é…ç½®æ–‡ä»¶è¯´æ˜.md) - å®Œæ•´çš„é…ç½®é¡¹è¯´æ˜
- [å¿«é€Ÿå¼€å§‹.md](./å¿«é€Ÿå¼€å§‹.md) - é¡¹ç›®å¿«é€Ÿå…¥é—¨
- [README.md](./README.md) - é¡¹ç›®å®Œæ•´æ–‡æ¡£

---

**æœ¬æŒ‡å—ç‰ˆæœ¬**: 1.0.0  
**æœ€åæ›´æ–°**: 2025å¹´12æœˆ9æ—¥

ç¥æ‚¨ä½¿ç”¨æ„‰å¿«ï¼ğŸ‰
